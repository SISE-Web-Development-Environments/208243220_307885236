Index: app.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>var context;\r\nvar shape = new Object();\r\nvar board;\r\nvar score;\r\nvar pac_color;\r\nvar start_time;\r\nvar time_elapsed;\r\nvar interval;\r\nvar center;\r\n\r\n//keyboards arguments\r\nvar keyUp;\r\nvar keyRight;\r\nvar keyDown;\r\nvar keyLeft;\r\n\r\nvar pacman = new Object();\r\npacman.img = new Image();\r\npacman.img.src = \"right.png\";\r\npacman.imgDown = new Image();\r\npacman.imgDown.src = \"down.png\";\r\npacman.imgUp = new Image();\r\npacman.imgUp.src = \"up.png\";\r\npacman.imgLeft = new Image();\r\npacman.imgLeft.src = \"left.png\";\r\npacman.imgRight = new Image();\r\npacman.imgRight.src = \"right.png\";\r\n\r\nvar monster = new Object();\r\nmonster.img = new Image();\r\nmonster.img.src = \"blue.png\";\r\nmonster.blue = new Image();\r\nmonster.blue.src = \"blue.png\";\r\nmonster.orange = new Image();\r\nmonster.orange.src = \"orange.png\";\r\nmonster.green = new Image();\r\nmonster.green.src = \"green.png\";\r\nmonster.red = new Image();\r\nmonster.red.src = \"red.png\";\r\n\r\nvar potionGood = new Object();\r\npotionGood.good = new Image();\r\npotionGood.good.src = \"goodp.png\";\r\nvar potionBad = new Object();\r\npotionBad.bad = new Image();\r\npotionBad.bad.src = \"badp.png\";\r\n\r\nvar clock = new Object();\r\nclock.img = new Image();\r\nclock.img.src = \"clock.png\";\r\n\r\nvar totalTimeOfGame;\r\nvar pacmanLife=5;\r\n\r\n$(document).ready(function () {\r\n    $(\"#startGameSettings\").click(function () {\r\n        context = canvas.getContext(\"2d\");\r\n        Start();\r\n\r\n        var paragraph = document.getElementById(\"userNameShow\");\r\n        var text = \"User Name: \" + document.getElementById(\"userNameLogIn\").value;\r\n        paragraph.innerText = text;\r\n\r\n    });\r\n});\r\n\r\n\r\n//var tmpTimeHilla;\r\nfunction Start() {\r\n    createMonsterPositions();\r\n    board = new Array();\r\n    score = 0;\r\n    pac_color = \"yellow\";\r\n    var cnt = 116;\r\n    var food_remain = document.getElementById(\"numberCookies\").value;\r\n    var pacman_remain = 1;\r\n    var goodpotion_remain=1;\r\n    var badpotion_remain=1;\r\n    var clockLife_remain=1;\r\n    start_time = new Date();\r\n    totalTimeOfGame = document.getElementById('gameTime').value;\r\n\r\n    for (var i = 0; i < 14; i++) {\r\n        board[i] = new Array();\r\n        //put obstacles in (i=3,j=3) and (i=3,j=4) and (i=3,j=5), (i=6,j=1) and (i=6,j=2)\r\n        for (var j = 0; j < 9; j++) {\r\n            if (\r\n                (i == 3 && j == 3) ||\r\n                (i == 3 && j == 4) ||\r\n                (i == 3 && j == 5) ||\r\n                (i == 6 && j == 1) ||\r\n                (i == 6 && j == 2) ||\r\n                (i == 8 && j == 7) ||\r\n                (i == 8 && j == 8) ||\r\n                (i == 1 && j == 7) ||\r\n                (i == 2 && j == 7) ||\r\n                (i == 3 && j == 7) ||\r\n                (i == 9 && j == 4) ||\r\n                (i == 10 && j == 4) ||\r\n                (i == 11 && j == 4) ||\r\n                (i == 10) && (j == 2)\r\n            ) {\r\n                board[i][j] = 4;\r\n            } else if ((i == 0 && j == 0)) {\r\n                board[i][j] = 6;\r\n            } else if ((i == 0 && j == 8)) {\r\n                board[i][j] = 7;\r\n            } else if ((i == 13 && j == 0)) {\r\n                board[i][j] = 8;\r\n            } else if ((i == 13 && j == 8)) {\r\n                board[i][j] = 9;\r\n            } else {\r\n                var randomNum = Math.random();\r\n                var randomPotion=Math.random();\r\n                var randomPotion1=Math.random();\r\n                var randomClock=Math.random();\r\n                if (randomNum <= (1.0 * food_remain) / cnt) {\r\n                    food_remain--;\r\n                    var randomNum2 = Math.random();\r\n                    var randomNum3 = Math.random();\r\n                    if (randomNum2 < 0.3) { //fifth\r\n                        board[i][j] = 3;\r\n                    } else if (randomNum3 < 0.1) { //twenty\r\n                        board[i][j] = 5;\r\n                    } else {\r\n                        board[i][j] = 1;\r\n                    }\r\n                } else if (randomNum < (1.0 * (pacman_remain + food_remain)) / cnt) {\r\n                    shape.i = i;\r\n                    shape.j = j;\r\n                    pacman_remain--;\r\n                    board[i][j] = 2;\r\n                } else if (goodpotion_remain===1 && randomPotion < 0.1){\r\n                    goodpotion_remain--;\r\n                    board[i][j] = 10;\r\n                } else if ( badpotion_remain===1 && randomPotion1 < 0.1){\r\n                    badpotion_remain--;\r\n                    board[i][j] = 11;\r\n                } else if ( clockLife_remain===1 && randomClock < 0.1){\r\n                    clockLife_remain--;\r\n                    board[i][j] = 12;\r\n                }else{\r\n                    board[i][j] = 0;\r\n                }\r\n                cnt--;\r\n            }\r\n        }\r\n    }\r\n    while (food_remain > 0) {\r\n        var emptyCell = findRandomEmptyCell(board);\r\n        board[emptyCell[0]][emptyCell[1]] = 1;\r\n        food_remain--;\r\n    }\r\n    keysDown = {};\r\n    addEventListener(\r\n        \"keydown\",\r\n        function (e) {\r\n            keysDown[e.keyCode] = true;\r\n        },\r\n        false\r\n    );\r\n    addEventListener(\r\n        \"keyup\",\r\n        function (e) {\r\n            keysDown[e.keyCode] = false;\r\n        },\r\n        false\r\n    );\r\n    interval = setInterval(UpdatePosition, 250);\r\n}\r\n\r\nfunction findRandomEmptyCell(board) {\r\n    var i = Math.floor(Math.random() * 9 + 1);\r\n    var j = Math.floor(Math.random() * 9 + 1);\r\n    while (board[i][j] != 0) {\r\n        i = Math.floor(Math.random() * 9 + 1);\r\n        j = Math.floor(Math.random() * 9 + 1);\r\n    }\r\n    return [i, j];\r\n}\r\n\r\nfunction GetKeyPressed() {\r\n    if (keysDown[38] || keysDown[keyUp]) {//up\r\n        pacman.img = pacman.imgUp;\r\n        return 1;\r\n    }\r\n    if (keysDown[40] || keysDown[keyDown]) {//down\r\n        pacman.img = pacman.imgDown;\r\n        return 2;\r\n    }\r\n    if (keysDown[37] || keysDown[keyLeft]) {//left\r\n        pacman.img = pacman.imgLeft;\r\n        return 3;\r\n    }\r\n    if (keysDown[39] || keysDown[keyRight]) {//right\r\n        pacman.img = pacman.imgRight;\r\n        return 4;\r\n    }\r\n}\r\n\r\n\r\nfunction Draw() {\r\n    canvas.width = canvas.width; //clean board\r\n    lblScore.value = score;\r\n    lblTime.value = time_elapsed;\r\n    lblLive.value= pacmanLife;\r\n    for (var i = 0; i < 14; i++) {\r\n        for (var j = 0; j < 9; j++) {\r\n            center = new Object();\r\n            center.x = i * 50 + 17;\r\n            center.y = j * 50 + 17;\r\n            if (board[i][j] === 2) {\r\n                context.drawImage(pacman.img, center.x - 18, center.y - 18, 40, 40);\r\n            } else if (board[i][j] === 1) {\r\n                context.beginPath();\r\n                context.arc(center.x, center.y, 8, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fiveCookie\").value; //color //dots-food\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x + 3, center.y - 3, 2, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fiveChip\").value; //color\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x - 4, center.y + 1, 2, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fiveChip\").value; //color\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x + 3, center.y + 4, 2, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fiveChip\").value; //color\r\n                context.fill();\r\n            } else if (board[i][j] === 4) {//walls\r\n\r\n//                 var grd = context.createRadialGradient(center.x - 25, center.y - 25,5,90,60,100);\r\n//                 context.addColorStop(0,\"#406CB2\");\r\n//                 context.addColorStop(1,\"white\");\r\n//\r\n// // Fill with gradient\r\n//                 context.fillStyle = grd;\r\n//                 context.fillRect(10,10,150,80);\r\n//\r\n\r\n                context.beginPath();\r\n                context.rect(center.x - 25, center.y - 25, 50, 50);\r\n                context.fillStyle = \"white\"; //color\r\n                context.fill();\r\n            } else if (board[i][j] === 3) {\r\n                context.beginPath();\r\n                context.arc(center.x, center.y, 12, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fifthCookie\").value; //color //dots-food\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x + 4, center.y - 5, 3, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fifthChip\").value; //color\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x - 6, center.y + 2, 3, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fifthChip\").value; //color\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x + 5, center.y + 6, 3, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"fifthChip\").value; //color\r\n                context.fill();\r\n            } else if (board[i][j] === 5) {\r\n                context.beginPath();\r\n                context.arc(center.x, center.y, 15, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"twentyCookie\").value; //color //dots-food\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x + 4, center.y - 8, 4, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"twentyChip\").value; //color\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x - 6, center.y + 2, 4, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"twentyChip\").value; //color\r\n                context.fill();\r\n                context.beginPath();\r\n                context.arc(center.x + 7, center.y + 6, 4, 0, 2 * Math.PI); // circle\r\n                context.fillStyle = document.getElementById(\"twentyChip\").value; //color\r\n                context.fill();\r\n            } else if (board[i][j] === 6) {\r\n                if (randomMonster1 === 0) {\r\n                    context.drawImage(monster.blue, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster2 === 0) {\r\n                    context.drawImage(monster.orange, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster3 === 0) {\r\n                    context.drawImage(monster.green, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster4 === 0) {\r\n                    context.drawImage(monster.red, center.x - 10, center.y - 18, 32, 34);\r\n                }\r\n            } else if (board[i][j] === 7) {\r\n                if (randomMonster1 === 1) {\r\n                    context.drawImage(monster.blue, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster2 === 1) {\r\n                    context.drawImage(monster.orange, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster3 === 1) {\r\n                    context.drawImage(monster.green, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster4 === 1) {\r\n                    context.drawImage(monster.red, center.x - 10, center.y - 18, 32, 34);\r\n                }\r\n            } else if (board[i][j] === 8) {\r\n                if (randomMonster1 === 2) {\r\n                    context.drawImage(monster.blue, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster2 === 2) {\r\n                    context.drawImage(monster.orange, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster3 === 2) {\r\n                    context.drawImage(monster.green, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster4 === 2) {\r\n                    context.drawImage(monster.red, center.x - 10, center.y - 18, 32, 34);\r\n                }\r\n            } else if (board[i][j] === 9) {\r\n                if (randomMonster1 === 3) {\r\n                    context.drawImage(monster.blue, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster2 === 3) {\r\n                    context.drawImage(monster.orange, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster3 === 3) {\r\n                    context.drawImage(monster.green, center.x - 10, center.y - 18, 32, 34);\r\n                } else if (randomMonster4 === 3) {\r\n                    context.drawImage(monster.red, center.x - 10, center.y - 18, 32, 34);\r\n                }\r\n            }else if(board[i][j]===10){\r\n                context.drawImage(potionGood.good, center.x - 18, center.y - 18, 40, 40);\r\n            }else if(board[i][j]===11){\r\n                context.drawImage(potionBad.bad, center.x - 18, center.y - 18, 40, 40);\r\n            }else if(board[i][j]===12){\r\n                context.drawImage(clock.img, center.x - 18, center.y - 18, 35, 35);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nvar tmpTime=0;\r\n\r\nfunction UpdatePosition() {\r\n    board[shape.i][shape.j] = 0;\r\n    var x = GetKeyPressed();\r\n    if (x === 1) {//up\r\n        if (shape.j > 0 && board[shape.i][shape.j - 1] !== 4) {\r\n            shape.j--;\r\n        }\r\n    }\r\n    if (x === 2) {\r\n        if (shape.j < 8 && board[shape.i][shape.j + 1] !== 4) {\r\n            shape.j++;\r\n        }\r\n    }\r\n    if (x === 3) { //left\r\n        if (shape.i > 0 && board[shape.i - 1][shape.j] !== 4) {\r\n            shape.i--;\r\n        }\r\n    }\r\n    if (x === 4) {\r\n        if (shape.i < 13 && board[shape.i + 1][shape.j] !== 4) {\r\n            shape.i++;\r\n        }\r\n    }\r\n    if (board[shape.i][shape.j] === 1) {\r\n        score += 5;\r\n    }\r\n    if (board[shape.i][shape.j] === 3) {\r\n        score += 15;\r\n    }\r\n    if (board[shape.i][shape.j] === 5) {\r\n        score += 25;\r\n    }\r\n    if (board[shape.i][shape.j] === 10) {\r\n        pacmanLife += 1;\r\n    }\r\n    if (board[shape.i][shape.j] === 11) {\r\n        pacmanLife -= 1;\r\n    }\r\n\r\n    if (board[shape.i][shape.j] === 12) {\r\n       tmpTime=20;\r\n      // alert(parseInt(totalTimeOfGame)+parseInt(tmpTime));\r\n       // totalTimeOfGame=totalTimeOfGame+tmpTime;\r\n    }\r\n    board[shape.i][shape.j] = 2;\r\n    var currentTime = new Date();\r\n    time_elapsed = (currentTime - start_time) / 1000;\r\n\r\n    //todo!\r\n    if (time_elapsed.valueOf() >= parseInt(totalTimeOfGame)+parseInt(tmpTime)) {\r\n        window.clearInterval(interval);\r\n        if (score < 100) {\r\n            window.alert(\"You are better than \" + score + \" points\");\r\n        } else {\r\n            window.alert(\"Winner!!!\");\r\n        }\r\n\r\n    } else {\r\n        Draw();\r\n    }\r\n}\r\n\r\n\r\n//stop scrolling\r\nwindow.addEventListener(\"keydown\", function (e) {\r\n    // arrow keys\r\n    if ([37, 38, 39, 40].indexOf(e.keyCode) > -1) {\r\n        e.preventDefault();\r\n    }\r\n}, false);\r\n\r\n\r\nfunction upPress(event) {\r\n    keyUp = parseInt(event.keyCode);\r\n}\r\n\r\nfunction rightPress(event) {\r\n    keyRight = parseInt(event.keyCode);\r\n}\r\n\r\nfunction downPress(event) {\r\n    keyDown = parseInt(event.keyCode);\r\n}\r\n\r\nfunction leftPress(event) {\r\n    keyLeft = parseInt(event.keyCode);\r\n}\r\n\r\nvar audio=new Audio(\"music.mp3\");\r\nvar img1 = \"mute.png\";\r\nvar img2 = \"unmute.png\";\r\n\r\nfunction musicController(){\r\n    var imgElement = document.getElementById('imageMusic');\r\n\r\n    imgElement.src = (imgElement.src === img1)? img2 : img1;\r\n    if(audio.play()){\r\n        audio.pause();\r\n    }else{\r\n        audio.play();\r\n    }\r\n}\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app.js	(revision 2766a98f41a914006e641b7ebc580710353f3a2d)
+++ app.js	(date 1587820039683)
@@ -334,6 +334,7 @@
     board[shape.i][shape.j] = 0;
     var x = GetKeyPressed();
     if (x === 1) {//up
+
         if (shape.j > 0 && board[shape.i][shape.j - 1] !== 4) {
             shape.j--;
         }
